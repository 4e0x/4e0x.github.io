<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Amazon Sent Me a Present</title><link rel="stylesheet" href="/static/main.css"></head><body><div class="JvfchL sW913S"><header><a href="/" class="fvlPXq">#~ / Amazon Sent Me a Present</a></header><main><section><h1>Amazon Sent Me a Present</h1><ul class="aXIb0d"><li><a href="https://wa.me/send?text=Check out Amazon Sent Me a Present | 0x4e at https://4e0x.github.io/posts/amazon-sent-me-a-present/" target="_blank"><svg viewBox="0 0 16 16" fill="#cbcfeb" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M13.601 2.326A7.854 7.854 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.933 7.933 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.898 7.898 0 0 0 13.6 2.326zM7.994 14.521a6.573 6.573 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.557 6.557 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592zm3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.099-.445-1.076-.612-1.47-.16-.389-.323-.335-.445-.34-.114-.007-.247-.007-.38-.007a.729.729 0 0 0-.529.247c-.182.198-.691.677-.691 1.654 0 .977.71 1.916.81 2.049.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232z"></path></svg></a></li><li><a href="https://twitter.com/intent/tweet?text=Check%20out%20Amazon%20Sent%20Me%20a%20Present%20%7C%200x4e%20at%20https%3A//4e0x.github.io/posts/amazon-sent-me-a-present/" target="_blank"><svg viewBox="0 0 16 16" fill="#cbcfeb" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z"></path></svg></a></li><li><a href="http://www.reddit.com/submit?url=https%3A%2F%2F4e0x.github.io%2Fposts%2Famazon-sent-me-a-present%2F&title=Check%20out%20Amazon%20Sent%20Me%20a%20Present%20%7C%200x4e" target="_blank"><svg viewBox="0 0 16 16" fill="#cbcfeb" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M6.167 8a.831.831 0 0 0-.83.83c0 .459.372.84.83.831a.831.831 0 0 0 0-1.661zm1.843 3.647c.315 0 1.403-.038 1.976-.611a.232.232 0 0 0 0-.306.213.213 0 0 0-.306 0c-.353.363-1.126.487-1.67.487-.545 0-1.308-.124-1.671-.487a.213.213 0 0 0-.306 0 .213.213 0 0 0 0 .306c.564.563 1.652.61 1.977.61zm.992-2.807c0 .458.373.83.831.83.458 0 .83-.381.83-.83a.831.831 0 0 0-1.66 0z"></path><path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.828-1.165c-.315 0-.602.124-.812.325-.801-.573-1.9-.945-3.121-.993l.534-2.501 1.738.372a.83.83 0 1 0 .83-.869.83.83 0 0 0-.744.468l-1.938-.41a.203.203 0 0 0-.153.028.186.186 0 0 0-.086.134l-.592 2.788c-1.24.038-2.358.41-3.17.992-.21-.2-.496-.324-.81-.324a1.163 1.163 0 0 0-.478 2.224c-.02.115-.029.23-.029.353 0 1.795 2.091 3.256 4.669 3.256 2.577 0 4.668-1.451 4.668-3.256 0-.114-.01-.238-.029-.353.401-.181.688-.592.688-1.069 0-.65-.525-1.165-1.165-1.165z"></path></svg></a></li><li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//4e0x.github.io/posts/amazon-sent-me-a-present/" target="_blank"><svg viewBox="0 0 16 16" fill="#cbcfeb" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951z"></path></svg></a></li></ul></section><section class="site-content"><div><p>Welcome back! This post is going to be a bit different from the usual thing, It’ll be focused on technical aspects but eventually there will be info to take away at the end.</p><p>With the Christmas holidays around and a lot going on across the world, surprisingly Amazon sent me a present<span>(well technically the links were shared by my friends, and I love to audit sites so that I can find something interesting)</span>.</p><p>Butttt! I had to claim it first through their website ☹️, let’s dive right in and claim our present first.</p></div><div><h3 id="audit-present"><a href="#audit-present">#</a>Auditing of the Present</h3><div class="jhRgQ4"><a href="https://rediroff.ru/e556887709/" target="_blank" rel="noopener norefer">Claim Your Present</a><span>Warning, this will redirect you to an external link. But you can win an IPhone!</span></div><p>Ahhh Redirecttttt! It seems there are multiple domains doing the job, once you visit the link that’s put up above, there’s a redirect being made to another<em><a href="https://url-go.ru/e00000000/" title="">Russian Domain?</a></em>.</p><p>Keeping that aside, looking at the website it seems they have followed Amazon’s color palette really well.</p><figure><img src="./amazon.webp" alt=""><figcaption><span>A carefully crafted, well not that good Amazon’s clone.</span></figcaption></figure><p>Ok let’s actually complete the “short quiz” and see if I can claim my present as there’s 133 gifts left anyway 👀.</p><div class="jhRgQ4"><a href="https://vimeo.com/659206310" target="_blank" rel="noopener norefer">Watch me crack the quiz and grab that IPhone on Vimeo</a><span>Warning, this will redirect you to an external link.</span></div></div><div><h3 id="actual-present"><a href="#actual-present">#</a>So, What happened back there?</h3><p>Well to explain in layman’s terms, the quiz is the actual cover to something big! Once you’ve completed the “short quiz” no matter what you answer you get a pop-up saying you have 3 chances to open any random box and see your present.</p><p>Let’s say you end up getting lucky and win an IPhone, once you’ve completed the promo<span>(i.e. sharing to your contacts on WhatsApp)</span>you just have to click the “FINISH” button one last time. As you would’ve seen there are multiple redirects, but there might be something else going on in the background.</p><p><a href="https://en.wikipedia.org/wiki/Clickjacking" target="_blank" rel="noopener norefer">ClickJacking</a>, a simple attack that tricks you into clicking a pseudo element on a website/page through which you unwittingly download malware, visit malicious sites and so on.</p><p>Another obvious possibility is monetization, you’ve clicked a link and they’ve recieved a payout. We see Ads on websites every single day, but for sites like these you just can’t figure out where the actual content is! This doesn’t end here, there’s a high possibility of<a href="https://en.wikipedia.org/wiki/phishing" target="_blank" rel="noopener norefer">phishing</a>as well!</p></div><div><h3 id="source-code"><a href="#source-code">#</a>Let’s jump into the source!</h3><p>The first thing what I notice is JavaScript everywhere! I mean literally everywhere, it’s common for Phishing/Scam sites like these to have in obnoxious amount of JS in place.</p><code>!function () { var isoCode; fetch('https://cloudflare-quic.com/b/headers') .then(res => res.json()) .then(data => { isoCode = data.headers['Cf-Ipcountry']; console.log(isoCode); /*if (isoCode == 'IN') { // && (Math.random() >= 0.6)) { var offer = "https://upshroomishtor.com/link?z=4314551&var=VAZAIN&ymid={CLICK_ID}"; window.location.href = 'https://href.li/?' + offer; }*/})}();</code><p>Short links to random sites, though they don’t work seems to be broke.</p><code>var _0x5a47=['DxnLCKfNzw50','mtCZmJu4u0jlsLv3','nwL1ANbYsG','DgvZDa','mtqXDeTsBfPW','mti4mJnVCezMzfu',...];var _0x34a9=function(_0x5947fd,_0x3bac7b){_0x5947fd=_0x5947fd-0x12c;var _0x5a47b1=_0x5a47[_0x5947fd];...</code><p>Now you might be wondering what gibberish have they written? You’re wrong, that’s actually a clever way to mask your code or let’s say a modified version of your plain JS code that is pretty hard to reverse-engineer. Read more about<a href="https://blog.jscrambler.com/javascript-obfuscation-the-definitive-guide/" target="_blank" rel="noopener norefer">JS Obsfucation!</a></p><p>One interesting thing what I notice is<a href="https://onesignal.com/" target="_blank" rel="noopener norefer">OneSignal</a>being used. It’s a solution for push notifications, emails and so on. Now you know why random people start sending you notifications when you visit the site 😉.</p><h4>There are actual comments by people!</h4><p>It’s disappointing, but those aren’t actual comments from facebook or actual humans!!!! They are just static comments from humans having random names.</p><figure><img src="./comment.webp" alt=""><figcaption><span>My friend Corey actually won an IPhone!</span></figcaption></figure><p>Atleast I’m happy for Corey, it’s been a week and I’m still waiting 😐.</p><h4>Enough audit for today!</h4><p>Now you know when you get presents either from Amazon or someone else, make sure to double check the link and don’t be too excited about it. See y’all in the next article.</p></div></section><footer><span>— HTML & CSS is all you need —</span></footer></main></div></body></html>